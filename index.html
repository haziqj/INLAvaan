<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian Latent Variable Analysis using INLA • INLAvaan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Latent Variable Analysis using INLA">
<meta name="description" content="INLAvaan is an R package that extends lavaan for Bayesian statistical modeling using Integrated Nested Laplace Approximations (INLA). It offers fast and efficient Bayesian inference for latent variable models, combining lavaan's structural equation modeling framework with the advanced computational speed of INLA.">
<meta property="og:description" content="INLAvaan is an R package that extends lavaan for Bayesian statistical modeling using Integrated Nested Laplace Approximations (INLA). It offers fast and efficient Bayesian inference for latent variable models, combining lavaan's structural equation modeling framework with the advanced computational speed of INLA.">
<meta property="og:image" content="https://inlavaan.haziqj.ml/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">INLAvaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/INLAvaan.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><h6 class="dropdown-header" data-toc-skip>Confirmatory factor analysis</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Structural equation modelling</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Growth curve modelling</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Equality constraints</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Multigroup analysis</h6></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/haziqj/INLAvaan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="inlavaan-">INLAvaan 
<a class="anchor" aria-label="anchor" href="#inlavaan-"></a>
</h1>
</div>
<!-- badges: start -->

<blockquote>
<p>Efficient approximate Bayesian inference for Structural Equation Models.</p>
</blockquote>
<p>While Markov Chain Monte Carlo (MCMC) methods remain the gold standard for exact Bayesian inference, they can be prohibitively slow for iterative model development. <a href="http://inlavaan.haziqj.ml/" class="external-link">INLAvaan</a> offers a rapid alternative for <strong>la</strong>tent <strong>va</strong>riable <strong>an</strong>alysis, delivering Bayesian results at (or near) the speed of frequentist estimators. It achieves this through a custom, ground-up implementation of the <a href="https://www.r-inla.org" class="external-link">Integrated Nested Laplace Approximation (INLA)</a>, engineered specifically for the <a href="https://lavaan.org" class="external-link">lavaan</a> modelling framework.</p>
<div class="section level2">
<h2 id="a-familiar-interface">A Familiar Interface<a class="anchor" aria-label="anchor" href="#a-familiar-interface"></a>
</h2>
<p><a href="http://inlavaan.haziqj.ml/" class="external-link">INLAvaan</a> is designed to fit seamlessly into your existing workflow. If you are familiar with the (b)lavaan syntax, you can begin using <a href="http://inlavaan.haziqj.ml/" class="external-link">INLAvaan</a> immediately.</p>
<p>As a first impression of the package, consider the canonical example of SEM applied to the Industrialisation and Political Democracy data set of Bollen (1989)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Bollen, K. A. (1989). &lt;em&gt;Structural equations with latent variables&lt;/em&gt; (pp. xiv, 514). John Wiley &amp;amp; Sons. &lt;a href="https://doi.org/10.1002/9781118619179" class="external-link uri"&gt;https://doi.org/10.1002/9781118619179&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  # Latent variable definitions</span></span>
<span><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">     dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">     dem65 =~ y5 + y6 + y7 + y8</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # (Latent) regressions</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # Residual correlations</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y4 + y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">    y6 ~~ y8</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Custom priors on latent variances</span></span>
<span><span class="st">    ind60 ~~ prior('gamma(1,.5)')*ind60</span></span>
<span><span class="st">    dem60 ~~ prior('gamma(2, 1)')*dem60</span></span>
<span><span class="st">    dem65 ~~ prior('gamma(2, 1)')*dem65</span></span>
<span><span class="st">"</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PoliticalDemocracy"</span>, package <span class="op">=</span> <span class="st">"lavaan"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/asem.html">asem</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">PoliticalDemocracy</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Using MVN log-likelihood.</span></span>
<span><span class="co">#&gt; ℹ Finding posterior mode.</span></span>
<span><span class="co">#&gt; ✔ Finding posterior mode. [109ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Computing the Hessian.</span></span>
<span><span class="co">#&gt; ✔ Computing the Hessian. [306ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Using skew normal approximation.</span></span>
<span><span class="co">#&gt; ℹ Fitting skew normal to marginals.</span></span>
<span><span class="co">#&gt; ✔ Fitting skew normal to marginals. [421ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Sampling posterior covariances.</span></span>
<span><span class="co">#&gt; ✔ Sampling posterior covariances. [106ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ⠙ Computing ppp and DIC.</span></span>
<span><span class="co">#&gt; ⠹ Computing ppp and DIC.</span></span>
<span><span class="co">#&gt; ⠸ Computing ppp and DIC.</span></span>
<span><span class="co">#&gt; ⠼ Computing ppp and DIC.</span></span>
<span><span class="co">#&gt; ✔ Computing ppp and DIC. [1s]</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; INLAvaan 0.2.0 ended normally after 70 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        31</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test (User Model):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Marginal log-likelihood                   -1641.399 </span></span>
<span><span class="co">#&gt;    PPP (Chi-square)                              0.525 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Deviance (DIC)                             3158.970 </span></span>
<span><span class="co">#&gt;    Effective parameters (pD)                    31.100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Marginalisation method                     SKEWNORM</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate       SD     2.5%      50%    97.5%     Mode    Prior       </span></span>
<span><span class="co">#&gt;   ind60 =~                                                                              </span></span>
<span><span class="co">#&gt;     x1                1.000                                                             </span></span>
<span><span class="co">#&gt;     x2                2.179    0.140    1.920    2.174    2.470    2.162    normal(0,10)</span></span>
<span><span class="co">#&gt;     x3                1.811    0.151    1.516    1.810    2.109    1.809    normal(0,10)</span></span>
<span><span class="co">#&gt;   dem60 =~                                                                              </span></span>
<span><span class="co">#&gt;     y1                1.000                                                             </span></span>
<span><span class="co">#&gt;     y2                1.294    0.196    0.930    1.286    1.699    1.271    normal(0,10)</span></span>
<span><span class="co">#&gt;     y3                1.088    0.152    0.799    1.085    1.396    1.078    normal(0,10)</span></span>
<span><span class="co">#&gt;     y4                1.300    0.157    1.002    1.297    1.620    1.289    normal(0,10)</span></span>
<span><span class="co">#&gt;   dem65 =~                                                                              </span></span>
<span><span class="co">#&gt;     y5                1.000                                                             </span></span>
<span><span class="co">#&gt;     y6                1.190    0.173    0.872    1.183    1.553    1.166    normal(0,10)</span></span>
<span><span class="co">#&gt;     y7                1.287    0.159    0.990    1.282    1.613    1.272    normal(0,10)</span></span>
<span><span class="co">#&gt;     y8                1.261    0.160    0.954    1.259    1.581    1.254    normal(0,10)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate       SD     2.5%      50%    97.5%     Mode    Prior       </span></span>
<span><span class="co">#&gt;   dem60 ~                                                                               </span></span>
<span><span class="co">#&gt;     ind60             1.472    0.383    0.722    1.471    2.223    1.470    normal(0,10)</span></span>
<span><span class="co">#&gt;   dem65 ~                                                                               </span></span>
<span><span class="co">#&gt;     ind60             0.578    0.247    0.089    0.579    1.059    0.582    normal(0,10)</span></span>
<span><span class="co">#&gt;     dem60             0.842    0.101    0.647    0.841    1.044    0.838    normal(0,10)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate       SD     2.5%      50%    97.5%     Mode    Prior       </span></span>
<span><span class="co">#&gt;  .y1 ~~                                                                                 </span></span>
<span><span class="co">#&gt;    .y5                0.299    0.360    0.038    0.635    1.449    0.572       beta(1,1)</span></span>
<span><span class="co">#&gt;  .y2 ~~                                                                                 </span></span>
<span><span class="co">#&gt;    .y4                0.254    0.723    0.006    1.176    2.833    1.030       beta(1,1)</span></span>
<span><span class="co">#&gt;    .y6                0.349    0.708    0.772    2.069    3.553    2.019       beta(1,1)</span></span>
<span><span class="co">#&gt;  .y3 ~~                                                                                 </span></span>
<span><span class="co">#&gt;    .y7                0.212    0.599   -0.283    0.891    2.066    0.891       beta(1,1)</span></span>
<span><span class="co">#&gt;  .y4 ~~                                                                                 </span></span>
<span><span class="co">#&gt;    .y8                0.121    0.448   -0.388    0.375    1.371    0.309       beta(1,1)</span></span>
<span><span class="co">#&gt;  .y6 ~~                                                                                 </span></span>
<span><span class="co">#&gt;    .y8                0.306    0.561    0.163    1.263    2.362    1.263       beta(1,1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate       SD     2.5%      50%    97.5%     Mode    Prior       </span></span>
<span><span class="co">#&gt;     ind60             0.478    0.096    0.323    0.467    0.697    0.446     gamma(1,.5)</span></span>
<span><span class="co">#&gt;    .dem60             3.766    0.847    2.390    3.669    5.693    3.486      gamma(2,1)</span></span>
<span><span class="co">#&gt;    .dem65             0.402    0.210    0.107    0.366    0.908    0.295      gamma(2,1)</span></span>
<span><span class="co">#&gt;    .x1                0.082    0.020    0.048    0.080    0.126    0.076 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .x2                0.132    0.070    0.034    0.120    0.303    0.096 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .x3                0.482    0.095    0.327    0.471    0.696    0.452 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y1                1.952    0.497    1.155    1.892    3.088    1.779 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y2                7.489    1.420    5.160    7.335   10.705    7.044 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y3                5.138    1.010    3.485    5.027    7.428    4.818 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y4                3.161    0.802    1.879    3.063    5.000    2.877 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y5                2.407    0.518    1.563    2.349    3.584    2.239 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y6                5.006    0.942    3.457    4.904    7.135    4.713 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y7                3.398    0.743    2.187    3.315    5.082    3.158 gamma(1,.5)[sd]</span></span>
<span><span class="co">#&gt;    .y8                3.248    0.729    2.068    3.164    4.908    3.005 gamma(1,.5)[sd]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="validation-against-mcmc">Validation Against MCMC<a class="anchor" aria-label="anchor" href="#validation-against-mcmc"></a>
</h2>
<p>Computation speed is valuable only when accuracy is preserved.</p>
<p>For many standard SEMs, the Laplace approximation yields posterior distributions that are visually and numerically comparable to those obtained via MCMC (e.g., via <a href="https://ecmerkle.github.io/blavaan/" class="external-link">blavaan</a>/Stan), but at a fraction of the computational cost.</p>
<p>The figure below illustrates the posterior density overlap for the example above:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("blavaan")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ecmerkle.github.io/blavaan/" class="external-link">blavaan</a></span><span class="op">)</span></span>
<span><span class="va">fit_blav</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://ecmerkle.github.io/blavaan/reference/bsem.html" class="external-link">bsem</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">PoliticalDemocracy</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">INLAvaan</span><span class="fu">:::</span><span class="fu">compare_mcmc</span><span class="op">(</span><span class="va">fit_blav</span>, INLAvaan <span class="op">=</span> <span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">p_compare</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-fig-compare-poldem-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the development version of <a href="http://inlavaan.haziqj.ml/" class="external-link">INLAvaan</a> from GitHub using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"haziqj/INLAvaan"</span><span class="op">)</span></span></code></pre></div>
<p><em>Optionally</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;R-INLA dependency has been removed temporarily for v0.2-0.&lt;/p&gt;"><sup>2</sup></a>, you may wish to install <a href="https://www.r-inla.org" class="external-link">INLA</a>. Following the official instructions given <a href="https://www.r-inla.org/download-install" class="external-link">here</a>, install the package by running this command in R:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span></span>
<span>  <span class="st">"INLA"</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span>, </span>
<span>            INLA <span class="op">=</span> <span class="st">"https://inla.r-inla-download.org/R/stable"</span><span class="op">)</span>, </span>
<span>  dep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<!-- ## Political democracy data -->
<!-- The quintessential example for SEM is this model from Bollen (1989) to fit a political democracy data set. -->
<!-- Eleven observed variables are hypothesized to arise from three latent variables. -->
<!-- This set includes data from 75 developing countries each assessed on four measures of democracy measured twice (1960 and 1965), and three measures of industrialization measured once (1960).  -->
<!-- The eleven observed variables are: -->
<!-- -   `y1`: Freedom of the press, 1960 -->
<!-- -   `y2`: Freedom of political opposition, 1960 -->
<!-- -   `y3`: Fairness of elections, 1960 -->
<!-- -   `y4`: Effectiveness of elected legislature, 1960 -->
<!-- -   `y5`: Freedom of the press, 1965 -->
<!-- -   `y6`: Freedom of political opposition, 1965 -->
<!-- -   `y7`: Fairness of elections, 1965 -->
<!-- -   `y8`: Effectiveness of elected legislature, 1965 -->
<!-- -   `y9`: GNP per capita, 1960 -->
<!-- -   `y10`: Energy consumption per capita, 1960 -->
<!-- -   `y11`: Percentage of labor force in industry, 1960 -->
<!-- Variables `y1-y4` and `y5-y8` are typically used as indicators of the latent trait of "political democracy" in 1960 and 1965 respectively, whereas `y9-y11` are used as indicators of industrialization (1960). -->
<!-- It is theorised that industrialisation influences political democracy, and that political democracy in 1960 influences political democracy in 1965. -->
<!-- Since the items measure the same latent trait at two time points, there is an assumption that the residuals of these items will be correlated with each other. -->
<!-- The model is depicted in the figure below. -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- knitr::include_graphics("https://lavaan.ugent.be/figures/sem.png") -->
<!-- ``` -->
<!-- The corresponding model in `{lavaan}` syntax is: -->
<!-- ```{r} -->
<!-- mod <- " -->
<!--   # latent variables -->
<!--   dem60 =~ y1 + y2 + y3 + y4 -->
<!--   dem65 =~ y5 + y6 + y7 + y8 -->
<!--   ind60 =~ x1 + x2 + x3 -->
<!--   # latent regressions -->
<!--   dem60 ~ ind60 -->
<!--   dem65 ~ ind60 + dem60 -->
<!--   # residual covariances -->
<!--   y1 ~~ y5 -->
<!--   y2 ~~ y4 + y6 -->
<!--   y3 ~~ y7 -->
<!--   y4 ~~ y8 -->
<!--   y6 ~~ y8 -->
<!-- " -->
<!-- ``` -->
<!-- We will fit this model using `{INLAvaan}` and compare the results with `{blavaan}`. -->
<!-- ```{r} -->
<!-- #| label: poldemfit -->
<!-- #| include: false -->
<!-- #| cache: true -->
<!-- data("PoliticalDemocracy", package = "lavaan") -->
<!-- poldemfit <- insem(mod, PoliticalDemocracy, meanstructure = !TRUE, bcontrol = list(num.threads = 6)) -->
<!-- library(future) -->
<!-- plan("multisession") -->
<!-- poldemfit_blav <- bsem( -->
<!--   model = mod,  -->
<!--   data = PoliticalDemocracy, -->
<!--   # meanstructure = TRUE, -->
<!--   n.chains = 3, -->
<!--   bcontrol = list(cores = 3) -->
<!--   # burnin = 5000, -->
<!--   # sample = 10000 -->
<!-- ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- data("PoliticalDemocracy", package = "lavaan") -->
<!-- poldemfit <- insem(model = mod, data = PoliticalDemocracy) -->
<!-- summary(poldemfit) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- summary(poldemfit) # -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| label: fig-poldem -->
<!-- #| echo: false -->
<!-- # -->
<!-- garb <- capture.output(tmp <- summary(poldemfit)) -->
<!-- PE_inla <- tibble( -->
<!--   est = as.numeric(tmp[, "Estimate"]), -->
<!--   ci.lower = as.numeric(tmp[, "pi.lower"]), -->
<!--   ci.upper = as.numeric(tmp[, "pi.upper"]) -->
<!-- ) |> -->
<!--   mutate(method = "INLAvaan") -->
<!-- garb <- capture.output(tmp <- summary(poldemfit_blav)) -->
<!-- PE_blav <- tibble( -->
<!--   est = as.numeric(tmp[, "Estimate"]), -->
<!--   ci.lower = as.numeric(tmp[, "pi.lower"]), -->
<!--   ci.upper = as.numeric(tmp[, "pi.upper"]) -->
<!-- ) |> -->
<!--   mutate(method = "blavaan") -->
<!-- bind_rows( -->
<!--   PE_inla, PE_blav -->
<!-- ) |> -->
<!--   mutate( -->
<!--     free = rep(partable(poldemfit)$free, 2), -->
<!--     pxnames = rep(partable(poldemfit)$pxnames, 2), -->
<!--     type = gsub("\\[[^]]*\\]", "", pxnames) -->
<!--   ) |> -->
<!--   drop_na() |> -->
<!--   mutate(names = factor(rep(names(coef(poldemfit)), 2), levels = rev(names(coef(fit))))) |> -->
<!--   pivot_wider( -->
<!--     names_from = method, -->
<!--     values_from = c(est, ci.lower, ci.upper) -->
<!--   ) |> -->
<!--   ggplot(aes(est_INLAvaan, est_blavaan, col = type)) + -->
<!--   geom_abline(slope = 1, intercept = 0, linetype = 2) + -->
<!--   geom_point(size = 3) + -->
<!--   geom_errorbar(aes(xmin = ci.lower_INLAvaan, xmax = ci.upper_INLAvaan), width = 0.1, alpha = 0.3) + -->
<!--   geom_errorbar(aes(ymin = ci.lower_blavaan, ymax = ci.upper_blavaan), width = 0.1, alpha = 0.3) + -->
<!--   theme_bw() + -->
<!--   labs( -->
<!--     x = "{INLAvaan} estimates", -->
<!--     y = "{blavaan} estimates", -->
<!--     col = "Parameter\ntype", -->
<!--     title = "Comparison of the estimates for the Political Democracy example", -->
<!--     caption = "MCMC conducted using Stan (3 parallel chains, 500 burnin, and 1500 samples)." -->
<!--   ) -->
<!-- cli::cli_h2("Compare timing (seconds)") -->
<!-- list(poldemfit, poldemfit_blav) |> -->
<!--   set_names(c("INLAvaan", "blavaan")) |> -->
<!--   purrr::map_dbl(\(x) x@timing$total)  -->
<!-- ``` -->
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>To cite package <a href="http://inlavaan.haziqj.ml/" class="external-link">INLAvaan</a> in publications use:</p>
<blockquote>
<p>Jamil, H (2025). <em>INLAvaan: Bayesian structural equation modelling with INLA</em> . R package version 0.2.0. URL: <a href="https://inlavaan.haziqj.ml/" class="uri">https://inlavaan.haziqj.ml/</a></p>
</blockquote>
<p>A BibTeX entry for LaTeX users is:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="va">@Manual</span>{,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="dt">title</span> = {INLAvaan: Bayesian structural equation modelling with INLA},</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="dt">author</span> = {Haziq Jamil},</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="dt">year</span> = {2025},</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="dt">note</span> = {R package version 0.2.0},</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="dt">url</span> = {https://inlavaan.haziqj.ml/},</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>The <a href="http://inlavaan.haziqj.ml/" class="external-link">INLAvaan</a> package is licensed under the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html" class="external-link">GPL-3</a>.</p>
<pre class="plaintext"><code>INLAvaan: Bayesian structural equation modelling with INLA
Copyright (C) 2025- Haziq Jamil

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code></pre>
<p>By using this package, you agree to comply with both licenses: the GPL-3 license for the software and the CC BY 4.0 license for the data.</p>
<!-- ## Outro -->
<!-- ```{r} -->
<!-- sessioninfo::session_info(info = "all") -->
<!-- ``` -->
</div>
</div>


  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/haziqj/INLAvaan/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/haziqj/INLAvaan/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing INLAvaan</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://haziqj.ml/" class="external-link">Haziq Jamil</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3298-1010" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/haziqj/INLAvaan/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/haziqj/INLAvaan/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/haziqj/INLAvaan?branch=main" class="external-link"><img src="https://codecov.io/gh/haziqj/INLAvaan/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://haziqj.ml/" class="external-link">Haziq Jamil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
